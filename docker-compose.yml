version: '3.8'

services:
  # Dashboard
  dashboard:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./dashboard:/usr/share/nginx/html
    networks:
      - public_net

  # SSRF Labs
  ssrf-lab1:
    build: ./ssrf/lab1
    ports:
      - "8001:80"
    networks:
      - lab_net
      - public_net

  ssrf-lab2:
    build: ./ssrf/lab2
    ports:
      - "8002:80"
    networks:
      - lab_net
      - public_net

  ssrf-lab3:
    build: ./ssrf/lab3
    ports:
      - "8003:80"
    networks:
      - lab_net
      - public_net

  ssrf-lab4:
    build: ./ssrf/lab4
    ports:
      - "8004:80"
    networks:
      - lab_net
      - public_net

  ssrf-lab5:
    build: ./ssrf/lab5
    ports:
      - "8005:80"
    networks:
      - lab_net
      - public_net

  ssrf-lab6:
    build: ./ssrf/lab6
    ports:
      - "8006:80"
    networks:
      - lab_net
      - public_net

  # SSTI Labs
  ssti-lab1:
    build: ./ssti/lab1
    ports:
      - "9001:80"
    networks:
      - public_net

  ssti-lab2:
    build: ./ssti/lab2
    ports:
      - "9002:80"
    networks:
      - public_net

  ssti-lab3:
    build: ./ssti/lab3
    ports:
      - "9003:80"
    networks:
      - public_net

  # CSTI Labs
  csti-lab1:
    build: ./csti/lab1
    ports:
      - "7001:80"
    networks:
      - public_net

  csti-lab2:
    build: ./csti/lab2
    ports:
      - "7002:80"
    networks:
      - public_net

  csti-lab3:
    build: ./csti/lab3
    ports:
      - "7003:80"
    networks:
      - public_net

  # Internal Services (Targets for SSRF)
  internal-admin:
    build: ./internal-services/admin
    networks:
      - lab_net

  internal-metadata:
    build: ./internal-services/metadata
    networks:
      - lab_net

  redis:
    image: redis:alpine
    networks:
      - lab_net

networks:
  public_net:
  lab_net:
    internal: true
